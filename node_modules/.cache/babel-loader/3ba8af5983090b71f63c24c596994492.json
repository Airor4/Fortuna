{"ast":null,"code":"import BoundingBox from './BoundingBox.js';\nimport CasusBlock from './CasusBlock.js';\nimport EmptyBlock from './EmptyBlock.js';\nimport Vec from './Vec.js';\nimport measureText from './measureText.js';\nimport generateCornerPerim from './generateCornerPerim.js';\nimport { CENTER_WIDTH, RAMP_WIDTH, VPADDING } from './generateCornerPerim.js';\n\nclass UnaryOperationBlock extends CasusBlock {\n  constructor(paramType, returnType, centerText) {\n    super();\n    this.rChild = new EmptyBlock(paramType);\n    this.paramType = paramType;\n    this.returnType = returnType;\n    this.centerText = centerText;\n    this.textWidth = measureText(centerText).w + CENTER_WIDTH;\n  }\n\n  precompBounds() {\n    this.rChild.precompBounds();\n    this.boundingBox = new BoundingBox(0, 0, RAMP_WIDTH + this.textWidth + this.rChild.boundingBox.w + RAMP_WIDTH, VPADDING + this.rChild.boundingBox.h + VPADDING);\n  }\n\n  precompXY(x, y) {\n    this.boundingBox.x = x;\n    this.boundingBox.y = y;\n    this.rChild.precompXY(x + RAMP_WIDTH + this.textWidth, y + VPADDING);\n  }\n\n  getChildBlocks() {\n    return [this.rChild];\n  }\n\n  removeBlockAt(v, removeAfter) {\n    if (!this.boundingBox.contains(v)) {\n      return [];\n    }\n\n    const rChildRes = this.rChild.removeBlockAt(v, removeAfter);\n\n    if (rChildRes.length > 0) {\n      return rChildRes;\n    }\n\n    if (this.rChild.boundingBox.contains(v) && this.rChild.draggable()) {\n      const toReturn = [this.rChild];\n      this.rChild = new EmptyBlock(this.paramType);\n      return toReturn;\n    }\n\n    return [];\n  }\n\n  getPerim() {\n    return generateCornerPerim(this.boundingBox, this.returnType);\n  }\n\n  drawSelf(ctx) {\n    ctx.fillStyle = '#eeee22';\n    const perim = this.getPerim();\n    ctx.beginPath();\n    ctx.moveTo(perim[0].x, perim[0].y);\n\n    for (const p of perim) {\n      ctx.lineTo(p.x, p.y);\n    }\n\n    ctx.fill();\n    ctx.fillStyle = '#000000';\n    ctx.font = '16px Arial';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillText(this.centerText, this.boundingBox.x + RAMP_WIDTH + this.textWidth / 2, this.boundingBox.y + this.boundingBox.h / 2);\n  }\n\n  getReturnType() {\n    return this.returnType;\n  }\n\n  tryToPlace(v, blockToPlace, ctx) {\n    var _this$rChild$tryToPla;\n\n    if (!this.boundingBox.contains(v)) {\n      return null;\n    }\n\n    this.rChild = (_this$rChild$tryToPla = this.rChild.tryToPlace(v, blockToPlace, ctx)) !== null && _this$rChild$tryToPla !== void 0 ? _this$rChild$tryToPla : this.rChild;\n    return null;\n  }\n\n}\n\nexport default UnaryOperationBlock;","map":{"version":3,"sources":["/Users/Airor/Desktop/Fortuna/Fortuna/fortuna/src/casus/blocks/UnaryOperationBlock.js"],"names":["BoundingBox","CasusBlock","EmptyBlock","Vec","measureText","generateCornerPerim","CENTER_WIDTH","RAMP_WIDTH","VPADDING","UnaryOperationBlock","constructor","paramType","returnType","centerText","rChild","textWidth","w","precompBounds","boundingBox","h","precompXY","x","y","getChildBlocks","removeBlockAt","v","removeAfter","contains","rChildRes","length","draggable","toReturn","getPerim","drawSelf","ctx","fillStyle","perim","beginPath","moveTo","p","lineTo","fill","font","textAlign","textBaseline","fillText","getReturnType","tryToPlace","blockToPlace"],"mappings":"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","sourcesContent":["//@flow strict\n\nimport BoundingBox from './BoundingBox.js';\nimport CasusBlock from './CasusBlock.js';\nimport EmptyBlock from './EmptyBlock.js';\nimport Vec from './Vec.js'\nimport measureText from './measureText.js';\nimport generateCornerPerim from './generateCornerPerim.js'\n\nimport {\n\tCENTER_WIDTH, \n\tRAMP_WIDTH, \n\tVPADDING, \n} from './generateCornerPerim.js';\n\nimport type {DataType} from './DataType.js'\n\nclass UnaryOperationBlock extends CasusBlock {\n\n\trChild: CasusBlock;\n\tparamType: DataType;\n\treturnType: DataType;\n\tcenterText: string;\n\ttextWidth: number;\n\n\tconstructor(paramType: DataType, returnType: DataType, centerText: string) {\n\t\tsuper();\n\n\t\tthis.rChild=new EmptyBlock(paramType);\n\t\tthis.paramType=paramType;\n\t\tthis.returnType=returnType;\n\t\tthis.centerText=centerText;\n\t\tthis.textWidth=measureText(centerText).w + CENTER_WIDTH;\n\t}\n\n\tprecompBounds(): void {\n\t\tthis.rChild.precompBounds();\n\n\t\tthis.boundingBox=new BoundingBox(\n\t\t\t0, \n\t\t\t0, \n\t\t\tRAMP_WIDTH + this.textWidth + this.rChild.boundingBox.w + RAMP_WIDTH, \n\t\t\tVPADDING + this.rChild.boundingBox.h + VPADDING\n\t\t);\t\n\t}\n\n\tprecompXY(x: number, y:number): void {\n\t\tthis.boundingBox.x=x;\n\t\tthis.boundingBox.y=y;\n\t\tthis.rChild.precompXY(x + RAMP_WIDTH + this.textWidth, y + VPADDING);\n\t}\n\n\tgetChildBlocks(): Array<CasusBlock> {\n\t\treturn [this.rChild];\n\t}\n\n\tremoveBlockAt(v: Vec, removeAfter: boolean): Array<CasusBlock> {\n\t\tif (!this.boundingBox.contains(v)) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst rChildRes = this.rChild.removeBlockAt(v, removeAfter);\n\t\tif (rChildRes.length > 0) {\n\t\t\treturn rChildRes;\n\t\t}\n\t\tif (this.rChild.boundingBox.contains(v) && this.rChild.draggable()) {\n\t\t\tconst toReturn=[this.rChild];\n\t\t\tthis.rChild=new EmptyBlock(this.paramType);\n\t\t\treturn toReturn;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tgetPerim(): Array<Vec> {\n\t\treturn generateCornerPerim(this.boundingBox, this.returnType);\n\t}\n\n\tdrawSelf(ctx: CanvasRenderingContext2D): void {\n\t\tctx.fillStyle = '#eeee22';\n\n\t\tconst perim: Array<Vec> = this.getPerim();\n\t\tctx.beginPath();\n\t\tctx.moveTo(perim[0].x, perim[0].y);\n\t\tfor (const p of perim) {\n\t\t\tctx.lineTo(p.x, p.y);\n\t\t}\n\t\tctx.fill();\n\n\t\tctx.fillStyle = '#000000';\n\t\tctx.font = '16px Arial';\n\t\tctx.textAlign = 'center';\n\t\tctx.textBaseline = 'middle';\n\n\t\tctx.fillText(\n\t\t\tthis.centerText, \n\t\t\tthis.boundingBox.x + RAMP_WIDTH + this.textWidth/2, \n\t\t\tthis.boundingBox.y + this.boundingBox.h/2\n\t\t);\n\t}\n\n\tgetReturnType(): DataType {\n\t\treturn this.returnType;\n\t}\n\n\ttryToPlace(v: Vec, blockToPlace: CasusBlock, ctx: ?CanvasRenderingContext2D): ?CasusBlock {\n\t\tif (!this.boundingBox.contains(v)) {\n\t\t\treturn null;\n\t\t}\n\t\tthis.rChild = this.rChild.tryToPlace(v, blockToPlace, ctx) ?? this.rChild;\n\t\treturn null;\n\t}\n\n}\n\nexport default UnaryOperationBlock;\n"]},"metadata":{},"sourceType":"module"}